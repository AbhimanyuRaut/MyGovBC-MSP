<button type="button" class="btn btn-default btn-xs pull-right" (click)="cancelDependent()" [innerHTML]="lang('./en/index.js').clearButton[person.relationship]">
</button>

<form #formRef='ngForm' novalidate>

  <h2 [innerHTML]="lang('./en/index.js').sectionTitle[person.relationship]"></h2>
  <p [innerHTML]="lang('./en/index.js').sectionBody[person.relationship]"></p>

  <label #firstFocus for="isExistingBeneficiary-{{person.id}}" [innerHtml]="lang('./en/index.js').isExistingBeneficiaryQuestion[person.relationship]"></label>
  <msp-toggle #isExistingBeneficiary [id]="'isExistingBeneficiary-'+ person.id" [(data)]="person.isExistingBeneficiary"></msp-toggle>
  
  <msp-status-in-canada-radio 
    *ngIf="person.isExistingBeneficiary===false" 
    [person]='person'>
  </msp-status-in-canada-radio>  


  <!-- Show this form to existing beneficiary's immediately, and only show it to
  new beneficiaries once they have set their status. -->
  <ng-container *ngIf="person.isExistingBeneficiary || (person.status || person.status === 0)">
    
    <msp-account-personal-details 
      [person]='person'  [showError]="showError"
      [id]='person.id'
      (onChange)="change($event)" 
      embedded=true
      [requirePHN]="person.isExistingBeneficiary">
    </msp-account-personal-details>

    <!-- Spouse-only Section, marriage date etc. -->
    <ng-container *ngIf="person.relationship === Relationship.Spouse">
      <div class="row">
        <div class="col-md-4 form-group"
          [ngClass]="{'has-error': !formRef.controls['spousePrevLastname-'+person.id]?.valid && (prevNameRef.touched || showError)}">
          
          <label for='addSpousePreviousLastName-{{person.id}}' [innerHTML]="lang('./en/index.js').previousName"></label>
          <input type="text" 
            name="spousePrevLastname-{{person.id}}" 
            class="form-control" 
            id='addSpousePreviousLastName-{{person.id}}' 
            maxlength="30"
            [pattern]="Person.NameRegEx"
            #prevNameRef="ngModel"
            [(ngModel)]="person.prevLastName">
          
          <div *ngIf='prevNameRef.touched || showError' role="alert" aria-live="assertive">
              <div class="text-danger" *ngIf="prevNameRef.errors?.pattern"[innerHtml]="lang('./en/index.js').previousNameErrorPattern"></div>
          </div>

        </div>
        <div class="col-md-4">
          <msp-date
            [label]="lang('./en/index.js').marriageDate"
            [showError]='showError'
            [(date)]="person.marriageDate"
            required=false
          ></msp-date>
        </div>
      </div>
    </ng-container> 
    <!-- End Spouse-only Section -->

    <!-- School information for child 19 to 24 -->
    <ng-container *ngIf="person.relationship === Relationship.Child19To24">
      <div class="row form-group">
        <div class="col-md-4">
            <label for='schoolName-{{person.id}}' [innerHTML]="lang('./en/index.js').schoolName"></label>

            <input type="text" 
            name="schoolName-{{person.id}}" 
            class="form-control" 
            id='schoolName-{{person.id}}' 
            maxlength="30"
            #schoolNameRef="ngModel"
            [pattern]="Person.NameRegEx"
            required
            [(ngModel)]="person.schoolName">

            <div *ngIf='schoolNameRef.touched || showError' role="alert" aria-live="assertive">
                <div class="text-danger" *ngIf="schoolNameRef.errors?.required"
                [innerHtml]="lang('./en/index.js').schoolNameRequired"></div>
                <div class="text-danger" *ngIf="schoolNameRef.errors?.pattern"[innerHtml]="lang('./en/index.js').previousNameErrorPattern"></div>
            </div>
        </div>
      </div>

      <div class="row form-group">
        <div class="col-md-4">
          <label for="isOutsideBC-{{person.id}}" [innerHtml]="lang('./en/index.js').schoolOutsideBC"></label>
      
          <msp-toggle [id]="'isOutsideBC-'+ person.id" [(data)]="person.schoolOutsideOfBC"></msp-toggle>
        </div>

        <div class="col-md-4 form-inline" *ngIf="person.schoolOutsideOfBC">
          <msp-date
            [label]="lang('./en/index.js').departureDate"
            [showError]='showError'
            [(date)]="person.studiesDepartureSimple"
          ></msp-date>
        </div>
      </div>



      <msp-address #schoolAddress
      [mailingAddressHeading]="lang('./en/index.js').schoolAddressLabel"
      [mailingAddress]="person.schoolAddress"
      [mailingOnly]="true"
      [showError] = "showError"
      hideProvinceAndCountry=true
      ></msp-address>

      <div class="row">
        <div class="col-md-6">
          <msp-date
            [label]="lang('./en/index.js').studiesBegin"
            [showError]='showError'
            [(date)]="person.studiesBeginSimple"
          ></msp-date>
        </div>

        <div class="col-md-6">
          <msp-date
            [label]="lang('./en/index.js').studiesFinish"
            [showError]='showError'
            [(date)]="person.studiesFinishedSimple"
          ></msp-date>
        </div>
      </div>

    </ng-container>

    <!-- Contains all questions if the user is a new beneficiary. -->
    <msp-add-new-dependent-beneficiary
      *ngIf="(person.status || person.status === 0)"
      [person]="person"
    ></msp-add-new-dependent-beneficiary>

  </ng-container> <!-- end dependent form container -->

</form>

<hr class='strong-hr'>