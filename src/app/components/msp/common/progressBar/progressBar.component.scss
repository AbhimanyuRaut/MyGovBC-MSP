@import "../../../../styles/variables.scss";
// Bootstrap 3 to 4: Included imports
@import "bootstrap/scss/functions";
@import "bootstrap/scss/variables";
@import "bootstrap/scss/mixins";

// Copied styles into a function to keep code DRY. Basically, it's a responsive
// calc(), setting the li.activeContainer to fill up the space so the entire
// progress bar is full width on smaller breakpoints.
// @NumOfItems are the total number of collapsed items in the progress bar
// excluding the last one, which should be 2 less than the total items.

//Bootstrap 3 to 4: Convert function to Mixin. Moved to file top (no hoisting).
//TODO: Test mixin works properly, specifically whether the string concatenation happening in the `width` attr is correct.  Currently believe it is
@mixin responsiveProgressBarItemFunction($NumOfItems) {

    //Bootstrap 3 to 4: Using breakpoint mixin.
    @include media-breakpoint-between(xs, sm){
    // @media screen and (min-width: $screen-xs) and (max-width: $screen-xs-max) { //TODO: Remove
        $collapsedItemSize: 58px;
        $finalCollapsedItemSize: 68px; // need to escape the calc() so LESS doesn't compile a value
        // width: ~"calc(100% - ("$collapsedItemSize~" * "$NumOfItems~") - ("$finalCollapsedItemSize~"))" !important;
        //TODO: TEST BELOW WORKS!
        width: "calc(100% - ( "$collapsedItemSize" * "$NumOfItems") - ("$finalCollapsedItemSize"))" !important;
    }

    //Bootstrap 3 to 4: Using breakpoint mixin.
    @include media-breakpoint-down(xs){
    // @media screen and (max-width: $screen-xs) { //TODO: Remove
        $collapsedItemSize: 41px;
        $finalCollapsedItemSize: 59px; // need to escape the calc() so LESS doesn't compile a value
        // width: ~"calc(100% - ("$collapsedItemSize~" * "$NumOfItems~") - ("$finalCollapsedItemSize~"))" !important;
        //TODO: TEST BELOW WORKS!
        width: "calc(100% - ("$collapsedItemSize" * "$NumOfItems") - ("$finalCollapsedItemSize"))" !important;
    }
}


.progressBar {
    text-align: left;
    display: table;
    table-layout: fixed;
    width: 100%;
}

.progressBar ul {
    list-style: none;
    display: table-row;
    margin: 0;
    padding: 0;
}

.progressBar ul li {
    list-style: none;
    display: inline-block;
    text-align: center;
    width: auto;
    //Bootstrap 3 to 4: Using breakpoint mixin.
    // @media screen and (min-width: $screen-sm) { //TODO:
    @include media-breakpoint-up(sm){
        min-width: 25%;
        display: table-cell;
    }
}

//Bootstrap 3 to 4: Using breakpoint mixin.
@include media-breakpoint-down(sm){
// @media screen and (max-width: $screen-xs-max){ /TODO:
    .progressBar ul li a.active span:first-of-type {
        padding-right: 5px;
    }
}

//Bootstrap 3 to 4: Using breakpoint mixin.
@include media-breakpoint-down(xs){
// @media screen and (max-width: $screen-xs){ //TODO:
    .progressBar ul li a span:first-of-type {
        display: none;
    }
}


.progressBar .beforeActive {
    background: #C8DCFD;
    color: #234075;
}

.progressBar .beforeActive:after {
    content: "";
    border-top: 20px solid transparent;
    border-bottom: 20px solid transparent;
    border-left: 20px solid #C8DCFD;
    position: absolute;
    right: -20px;
    top: 0;
    z-index: 1;
}

.progressBar .active {
    background: #FBE78C;
    cursor: not-allowed;
    pointer-events: none;
    color: #234075;
}

.progressBar .active:after {
    content: "";
    border-top: 20px solid transparent;
    border-bottom: 20px solid transparent;
    border-left: 20px solid #FBE78C;
    position: absolute;
    right: -20px;
    top: 0;
    z-index: 1;
}

.progressBar .afterActive {
    background: #E3E4E5;
    cursor: not-allowed;
    pointer-events: none;
    //Bootstrap 3 to 4: Change access of brand colours
    // color: $gray-light; //TODO: Remove
    color: map-get($theme-colors, primary);
}

.progressBar .afterActive:after {
    content: "";
    border-top: 20px solid transparent;
    border-bottom: 20px solid transparent;
    border-left: 20px solid #E3E4E5;
    position: absolute;
    right: -20px;
    top: 0;
    z-index: 1;
}

.progressBar ul li a {
    display: block;
    float: none;
    height: 40px;
    text-align: center;
    padding: 7px 10px 0 30px;
    position: relative;
    margin: 0 5px 0 0;
    //Bootstrap 3 to 4: Changed variable from $font-size-h3 to $h3-font-size
    // font-size: $font-size-h3;
    font-size: $h3-font-size;
    text-decoration: none;
    color: black;
    // @media(max-width: $screen-xs) { //TODO:
    //Bootstrap 3 to 4: Using breakpoint mixin.
    @include media-breakpoint-down(xs){
        padding: 7px 2px 0 24px;
        margin: 0 2px 0 0;
        text-align: left;
    }
    //Bootstrap 3 to 4: Using breakpoint mixin.
    @include media-breakpoint-down(md){
    // @media(max-width: $screen-md) { //TODO:
        //Bootstrap 3 to 4: Changed variable from $font-size-h4 to $h4-font-size
        // font-size: $font-size-h4; //TODO: Remove
        font-size: $h4-font-size;
    }
}

.progressBar ul li a:before {
    content: "";
    border-top: 20px solid transparent;
    border-bottom: 20px solid transparent;
    border-left: 20px solid #fff;
    position: absolute;
    left: 0;
    top: 0;
}

.progressBar ul li:first-child a {
    border-top-left-radius: 0px;
    //Bootstrap 3 to 4: Changed $btn-border-radius-base to $btn-border-radius
    // border-bottom-left-radius: $btn-border-radius-base;//TODO: Remove
    border-bottom-left-radius: $btn-border-radius;
}

.progressBar ul li:first-child a:before {
    display: none;
}

.progressBar ul li:last-child a {
    padding-right: 20px;
    border-top-right-radius: 0px;
    //Bootstrap 3 to 4: Changed $btn-border-radius-base to $btn-border-radius
    // border-bottom-right-radius: $btn-border-radius-base; //TODO: Remove
    border-bottom-right-radius: $btn-border-radius;
}

.progressBar ul li:last-child a:after {
    display: none;
}

.progressBar ul li a:hover {
    background: #234075;
    color: #fff;
}

.progressBar ul li a:hover:after {
    border-left-color: #234075;
    color: #fff;
}

.progressBarType-account {

    ul>li>a {
        height: 60px; 

        //Bootstrap 3 to 4: Using breakpoint mixin.
        @include media-breakpoint-between(sm, md){
        // @media screen and (min-width: $screen-sm) and (max-width: $screen-sm-max) { //TODO:
            //Hacky little ways to squeeze every pixel of space we can get.
            padding: 7px 10px 0 27px;
        }
    }


    //Bootstrap 3 to 4: Using breakpoint mixin.
    @include media-breakpoint-down(xs){
    // @media screen and (max-width: $screen-xs-max) { //TODO:
        ul {
            min-height: 80px;
            height: 100%;
            //Animate the height transition from angular
            transition: height 0.2s ease-out;
        }

        ul>li {
            width: auto !important; //Override angular inline styling on the smaller breakpoints
            height: inherit;
            min-height: inherit;

            > a {
                // height: 100%;
                height: inherit;
                min-height: inherit;
                > span { display: table-cell; }
            }
        }
    }


    &.progressBarCount-4 li.activeContainer {
        @include responsiveProgressBarItemFunction(2);
    }
    &.progressBarCount-5 li.activeContainer {
        @include responsiveProgressBarItemFunction(3);
    }

    //Bootstrap 3 to 4: Using breakpoint mixin.
    @include media-breakpoint-up(sm){
    // @media screen and (min-width: $screen-sm) { //TODO:
        &.progressBar-lg>ul>li>a {
            height: 115px;
        }
        &.progressBar-md>ul>li>a {
            height: 90px;
        }
        &.progressBar-sm>ul>li>a {
            height: 80px;
        }
        &.progressBar-xs>ul>li>a {
            height: 60px;
        }
    }
}